(self.webpackChunkmelee_wrapped=self.webpackChunkmelee_wrapped||[]).push([[222],{2556:function(e,t,n){"use strict";var a=n(4165),r=n(5861),i=n(3837),s=[2,3,8,28,31,32],o=new FileReaderSync,l=function(e){var t=o.readAsArrayBuffer(e),n=new i.v6(new Uint8Array(t)),a=n.getMetadata();if(function(e){var t,n,a,r,i,s,o,l;return e.lastFrame<2400||!e.startAt.startsWith("2022")||2!==Object.keys(e.players).length||null===(t=e.players[0])||void 0===t||null===(n=t.names)||void 0===n||!n.netplay||null===(a=e.players[0])||void 0===a||null===(r=a.names)||void 0===r||!r.code||null===(i=e.players[1])||void 0===i||null===(s=i.names)||void 0===s||!s.netplay||null===(o=e.players[1])||void 0===o||null===(l=o.names)||void 0===l||!l.code}(a))return null;var r=n.getStats();return function(e){var t=e.settings,n=e.stocks,a=e.inputs;if(t.is_teams)return!0;if(!s.includes(t.stageId))return!0;if(![2,8].includes(t.gameMode))return!0;var r=n.filter((function(e){return 0===e.playerIndex&&e.endFrame})).length,i=n.filter((function(e){return 1===e.playerIndex&&e.endFrame})).length;if(r<=2&&i<=2)return!0;var o=a[0].airborne,l=a[1].airborne;return!o&&!l}(r)?null:{metadata:a,stats:r}};self.onmessage=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n,r,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.data,r=n.file,i=l(r),self.postMessage(i);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},3837:function(e,t,n){"use strict";var a,r=n(2122).default,i=n(861).default,s=n(4704).default,o=n(1655).default,l=n(6389).default,u=n(6690).default,T=n(9728).default,E=n(8416).default;var c=n(405),_=n(3765),A=n(7186),f=n(895),m=n(8788),R=n(5479),d=n(4454);function h(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var S,p,I=h(c),N=h(A),C=h(R);t.zk=void 0,(S=t.zk||(t.zk={}))[S.CAPTAIN_FALCON=0]="CAPTAIN_FALCON",S[S.DONKEY_KONG=1]="DONKEY_KONG",S[S.FOX=2]="FOX",S[S.GAME_AND_WATCH=3]="GAME_AND_WATCH",S[S.KIRBY=4]="KIRBY",S[S.BOWSER=5]="BOWSER",S[S.LINK=6]="LINK",S[S.LUIGI=7]="LUIGI",S[S.MARIO=8]="MARIO",S[S.MARTH=9]="MARTH",S[S.MEWTWO=10]="MEWTWO",S[S.NESS=11]="NESS",S[S.PEACH=12]="PEACH",S[S.PIKACHU=13]="PIKACHU",S[S.ICE_CLIMBERS=14]="ICE_CLIMBERS",S[S.JIGGLYPUFF=15]="JIGGLYPUFF",S[S.SAMUS=16]="SAMUS",S[S.YOSHI=17]="YOSHI",S[S.ZELDA=18]="ZELDA",S[S.SHEIK=19]="SHEIK",S[S.FALCO=20]="FALCO",S[S.YOUNG_LINK=21]="YOUNG_LINK",S[S.DR_MARIO=22]="DR_MARIO",S[S.ROY=23]="ROY",S[S.PICHU=24]="PICHU",S[S.GANONDORF=25]="GANONDORF",S[S.MASTER_HAND=26]="MASTER_HAND",S[S.WIREFRAME_MALE=27]="WIREFRAME_MALE",S[S.WIREFRAME_FEMALE=28]="WIREFRAME_FEMALE",S[S.GIGA_BOWSER=29]="GIGA_BOWSER",S[S.CRAZY_HAND=30]="CRAZY_HAND",S[S.SANDBAG=31]="SANDBAG",S[S.POPO=32]="POPO",t.Hf=void 0,(p=t.Hf||(t.Hf={}))[p.FOUNTAIN_OF_DREAMS=2]="FOUNTAIN_OF_DREAMS",p[p.POKEMON_STADIUM=3]="POKEMON_STADIUM",p[p.PEACHS_CASTLE=4]="PEACHS_CASTLE",p[p.KONGO_JUNGLE=5]="KONGO_JUNGLE",p[p.BRINSTAR=6]="BRINSTAR",p[p.CORNERIA=7]="CORNERIA",p[p.YOSHIS_STORY=8]="YOSHIS_STORY",p[p.ONETT=9]="ONETT",p[p.MUTE_CITY=10]="MUTE_CITY",p[p.RAINBOW_CRUISE=11]="RAINBOW_CRUISE",p[p.JUNGLE_JAPES=12]="JUNGLE_JAPES",p[p.GREAT_BAY=13]="GREAT_BAY",p[p.HYRULE_TEMPLE=14]="HYRULE_TEMPLE",p[p.BRINSTAR_DEPTHS=15]="BRINSTAR_DEPTHS",p[p.YOSHIS_ISLAND=16]="YOSHIS_ISLAND",p[p.GREEN_GREENS=17]="GREEN_GREENS",p[p.FOURSIDE=18]="FOURSIDE",p[p.MUSHROOM_KINGDOM=19]="MUSHROOM_KINGDOM",p[p.MUSHROOM_KINGDOM_2=20]="MUSHROOM_KINGDOM_2",p[p.VENOM=22]="VENOM",p[p.POKE_FLOATS=23]="POKE_FLOATS",p[p.BIG_BLUE=24]="BIG_BLUE",p[p.ICICLE_MOUNTAIN=25]="ICICLE_MOUNTAIN",p[p.ICETOP=26]="ICETOP",p[p.FLAT_ZONE=27]="FLAT_ZONE",p[p.DREAMLAND=28]="DREAMLAND",p[p.YOSHIS_ISLAND_N64=29]="YOSHIS_ISLAND_N64",p[p.KONGO_JUNGLE_N64=30]="KONGO_JUNGLE_N64",p[p.BATTLEFIELD=31]="BATTLEFIELD",p[p.FINAL_DESTINATION=32]="FINAL_DESTINATION",p[p.TARGET_TEST_MARIO=33]="TARGET_TEST_MARIO",p[p.TARGET_TEST_CAPTAIN_FALCON=34]="TARGET_TEST_CAPTAIN_FALCON",p[p.TARGET_TEST_YOUNG_LINK=35]="TARGET_TEST_YOUNG_LINK",p[p.TARGET_TEST_DONKEY_KONG=36]="TARGET_TEST_DONKEY_KONG",p[p.TARGET_TEST_DR_MARIO=37]="TARGET_TEST_DR_MARIO",p[p.TARGET_TEST_FALCO=38]="TARGET_TEST_FALCO",p[p.TARGET_TEST_FOX=39]="TARGET_TEST_FOX",p[p.TARGET_TEST_ICE_CLIMBERS=40]="TARGET_TEST_ICE_CLIMBERS",p[p.TARGET_TEST_KIRBY=41]="TARGET_TEST_KIRBY",p[p.TARGET_TEST_BOWSER=42]="TARGET_TEST_BOWSER",p[p.TARGET_TEST_LINK=43]="TARGET_TEST_LINK",p[p.TARGET_TEST_LUIGI=44]="TARGET_TEST_LUIGI",p[p.TARGET_TEST_MARTH=45]="TARGET_TEST_MARTH",p[p.TARGET_TEST_MEWTWO=46]="TARGET_TEST_MEWTWO",p[p.TARGET_TEST_NESS=47]="TARGET_TEST_NESS",p[p.TARGET_TEST_PEACH=48]="TARGET_TEST_PEACH",p[p.TARGET_TEST_PICHU=49]="TARGET_TEST_PICHU",p[p.TARGET_TEST_PIKACHU=50]="TARGET_TEST_PIKACHU",p[p.TARGET_TEST_JIGGLYPUFF=51]="TARGET_TEST_JIGGLYPUFF",p[p.TARGET_TEST_SAMUS=52]="TARGET_TEST_SAMUS",p[p.TARGET_TEST_SHEIK=53]="TARGET_TEST_SHEIK",p[p.TARGET_TEST_YOSHI=54]="TARGET_TEST_YOSHI",p[p.TARGET_TEST_ZELDA=55]="TARGET_TEST_ZELDA",p[p.TARGET_TEST_GAME_AND_WATCH=56]="TARGET_TEST_GAME_AND_WATCH",p[p.TARGET_TEST_ROY=57]="TARGET_TEST_ROY",p[p.TARGET_TEST_GANONDORF=58]="TARGET_TEST_GANONDORF",p[p.HOME_RUN_CONTEST=84]="HOME_RUN_CONTEST";var O={id:-1,name:"Unknown Character",shortName:"Unknown",colors:["Default"]},D=[{id:t.zk.CAPTAIN_FALCON,name:"Captain Falcon",shortName:"Falcon",colors:["Default","Black","Red","White","Green","Blue"]},{id:t.zk.DONKEY_KONG,name:"Donkey Kong",shortName:"DK",colors:["Default","Black","Red","Blue","Green"]},{id:t.zk.FOX,name:"Fox",shortName:"Fox",colors:["Default","Red","Blue","Green"]},{id:t.zk.GAME_AND_WATCH,name:"Mr. Game & Watch",shortName:"G&W",colors:["Default","Red","Blue","Green"]},{id:t.zk.KIRBY,name:"Kirby",shortName:"Kirby",colors:["Default","Yellow","Blue","Red","Green","White"]},{id:t.zk.BOWSER,name:"Bowser",shortName:"Bowser",colors:["Default","Red","Blue","Black"]},{id:t.zk.LINK,name:"Link",shortName:"Link",colors:["Default","Red","Blue","Black","White"]},{id:t.zk.LUIGI,name:"Luigi",shortName:"Luigi",colors:["Default","White","Blue","Red"]},{id:t.zk.MARIO,name:"Mario",shortName:"Mario",colors:["Default","Yellow","Black","Blue","Green"]},{id:t.zk.MARTH,name:"Marth",shortName:"Marth",colors:["Default","Red","Green","Black","White"]},{id:t.zk.MEWTWO,name:"Mewtwo",shortName:"Mewtwo",colors:["Default","Red","Blue","Green"]},{id:t.zk.NESS,name:"Ness",shortName:"Ness",colors:["Default","Yellow","Blue","Green"]},{id:t.zk.PEACH,name:"Peach",shortName:"Peach",colors:["Default","Daisy","White","Blue","Green"]},{id:t.zk.PIKACHU,name:"Pikachu",shortName:"Pikachu",colors:["Default","Red","Party Hat","Cowboy Hat"]},{id:t.zk.ICE_CLIMBERS,name:"Ice Climbers",shortName:"ICs",colors:["Default","Green","Orange","Red"]},{id:t.zk.JIGGLYPUFF,name:"Jigglypuff",shortName:"Puff",colors:["Default","Red","Blue","Headband","Crown"]},{id:t.zk.SAMUS,name:"Samus",shortName:"Samus",colors:["Default","Pink","Black","Green","Purple"]},{id:t.zk.YOSHI,name:"Yoshi",shortName:"Yoshi",colors:["Default","Red","Blue","Yellow","Pink","Cyan"]},{id:t.zk.ZELDA,name:"Zelda",shortName:"Zelda",colors:["Default","Red","Blue","Green","White"]},{id:t.zk.SHEIK,name:"Sheik",shortName:"Sheik",colors:["Default","Red","Blue","Green","White"]},{id:t.zk.FALCO,name:"Falco",shortName:"Falco",colors:["Default","Red","Blue","Green"]},{id:t.zk.YOUNG_LINK,name:"Young Link",shortName:"YLink",colors:["Default","Red","Blue","White","Black"]},{id:t.zk.DR_MARIO,name:"Dr. Mario",shortName:"Doc",colors:["Default","Red","Blue","Green","Black"]},{id:t.zk.ROY,name:"Roy",shortName:"Roy",colors:["Default","Red","Blue","Green","Yellow"]},{id:t.zk.PICHU,name:"Pichu",shortName:"Pichu",colors:["Default","Red","Blue","Green"]},{id:t.zk.GANONDORF,name:"Ganondorf",shortName:"Ganon",colors:["Default","Red","Blue","Green","Purple"]}];function G(e){return D[e]||O}var M={__proto__:null,UnknownCharacter:O,getAllCharacters:function(){return D},getCharacterInfo:G,getCharacterShortName:function(e){return G(e).shortName},getCharacterName:function(e){return G(e).name},getCharacterColorName:function(e,t){return G(e).colors[t]||"Default"}},g={id:-1,name:"Unknown Move",shortName:"unknown"},v={1:{id:1,name:"Miscellaneous",shortName:"misc"},2:{id:2,name:"Jab",shortName:"jab"},3:{id:3,name:"Jab",shortName:"jab"},4:{id:4,name:"Jab",shortName:"jab"},5:{id:5,name:"Rapid Jabs",shortName:"rapid-jabs"},6:{id:6,name:"Dash Attack",shortName:"dash"},7:{id:7,name:"Forward Tilt",shortName:"ftilt"},8:{id:8,name:"Up Tilt",shortName:"utilt"},9:{id:9,name:"Down Tilt",shortName:"dtilt"},10:{id:10,name:"Forward Smash",shortName:"fsmash"},11:{id:11,name:"Up Smash",shortName:"usmash"},12:{id:12,name:"Down Smash",shortName:"dsmash"},13:{id:13,name:"Neutral Air",shortName:"nair"},14:{id:14,name:"Forward Air",shortName:"fair"},15:{id:15,name:"Back Air",shortName:"bair"},16:{id:16,name:"Up Air",shortName:"uair"},17:{id:17,name:"Down Air",shortName:"dair"},18:{id:18,name:"Neutral B",shortName:"neutral-b"},19:{id:19,name:"Side B",shortName:"side-b"},20:{id:20,name:"Up B",shortName:"up-b"},21:{id:21,name:"Down B",shortName:"down-b"},50:{id:50,name:"Getup Attack",shortName:"getup"},51:{id:51,name:"Getup Attack (Slow)",shortName:"getup-slow"},52:{id:52,name:"Grab Pummel",shortName:"pummel"},53:{id:53,name:"Forward Throw",shortName:"fthrow"},54:{id:54,name:"Back Throw",shortName:"bthrow"},55:{id:55,name:"Up Throw",shortName:"uthrow"},56:{id:56,name:"Down Throw",shortName:"dthrow"},61:{id:61,name:"Edge Attack (Slow)",shortName:"edge-slow"},62:{id:62,name:"Edge Attack",shortName:"edge"}};function y(e){return v[e]||g}var F={__proto__:null,UnknownMove:g,getMoveInfo:y,getMoveShortName:function(e){return y(e).shortName},getMoveName:function(e){return y(e).name}},H={id:-1,name:"Unknown Stage"},L=(E(a={},t.Hf.FOUNTAIN_OF_DREAMS,{id:t.Hf.FOUNTAIN_OF_DREAMS,name:"Fountain of Dreams"}),E(a,t.Hf.POKEMON_STADIUM,{id:t.Hf.POKEMON_STADIUM,name:"Pok\xe9mon Stadium"}),E(a,t.Hf.PEACHS_CASTLE,{id:t.Hf.PEACHS_CASTLE,name:"Princess Peach's Castle"}),E(a,t.Hf.KONGO_JUNGLE,{id:t.Hf.KONGO_JUNGLE,name:"Kongo Jungle"}),E(a,t.Hf.BRINSTAR,{id:t.Hf.BRINSTAR,name:"Brinstar"}),E(a,t.Hf.CORNERIA,{id:t.Hf.CORNERIA,name:"Corneria"}),E(a,t.Hf.YOSHIS_STORY,{id:t.Hf.YOSHIS_STORY,name:"Yoshi's Story"}),E(a,t.Hf.ONETT,{id:t.Hf.ONETT,name:"Onett"}),E(a,t.Hf.MUTE_CITY,{id:t.Hf.MUTE_CITY,name:"Mute City"}),E(a,t.Hf.RAINBOW_CRUISE,{id:t.Hf.RAINBOW_CRUISE,name:"Rainbow Cruise"}),E(a,t.Hf.JUNGLE_JAPES,{id:t.Hf.JUNGLE_JAPES,name:"Jungle Japes"}),E(a,t.Hf.GREAT_BAY,{id:t.Hf.GREAT_BAY,name:"Great Bay"}),E(a,t.Hf.HYRULE_TEMPLE,{id:t.Hf.HYRULE_TEMPLE,name:"Hyrule Temple"}),E(a,t.Hf.BRINSTAR_DEPTHS,{id:t.Hf.BRINSTAR_DEPTHS,name:"Brinstar Depths"}),E(a,t.Hf.YOSHIS_ISLAND,{id:t.Hf.YOSHIS_ISLAND,name:"Yoshi's Island"}),E(a,t.Hf.GREEN_GREENS,{id:t.Hf.GREEN_GREENS,name:"Green Greens"}),E(a,t.Hf.FOURSIDE,{id:t.Hf.FOURSIDE,name:"Fourside"}),E(a,t.Hf.MUSHROOM_KINGDOM,{id:t.Hf.MUSHROOM_KINGDOM,name:"Mushroom Kingdom I"}),E(a,t.Hf.MUSHROOM_KINGDOM_2,{id:t.Hf.MUSHROOM_KINGDOM_2,name:"Mushroom Kingdom II"}),E(a,t.Hf.VENOM,{id:t.Hf.VENOM,name:"Venom"}),E(a,t.Hf.POKE_FLOATS,{id:t.Hf.POKE_FLOATS,name:"Pok\xe9 Floats"}),E(a,t.Hf.BIG_BLUE,{id:t.Hf.BIG_BLUE,name:"Big Blue"}),E(a,t.Hf.ICICLE_MOUNTAIN,{id:t.Hf.ICICLE_MOUNTAIN,name:"Icicle Mountain"}),E(a,t.Hf.ICETOP,{id:t.Hf.ICETOP,name:"Icetop"}),E(a,t.Hf.FLAT_ZONE,{id:t.Hf.FLAT_ZONE,name:"Flat Zone"}),E(a,t.Hf.DREAMLAND,{id:t.Hf.DREAMLAND,name:"Dream Land N64"}),E(a,t.Hf.YOSHIS_ISLAND_N64,{id:t.Hf.YOSHIS_ISLAND_N64,name:"Yoshi's Island N64"}),E(a,t.Hf.KONGO_JUNGLE_N64,{id:t.Hf.KONGO_JUNGLE_N64,name:"Kongo Jungle N64"}),E(a,t.Hf.BATTLEFIELD,{id:t.Hf.BATTLEFIELD,name:"Battlefield"}),E(a,t.Hf.FINAL_DESTINATION,{id:t.Hf.FINAL_DESTINATION,name:"Final Destination"}),E(a,t.Hf.TARGET_TEST_MARIO,{id:t.Hf.TARGET_TEST_MARIO,name:"Target Test (Mario)"}),E(a,t.Hf.TARGET_TEST_CAPTAIN_FALCON,{id:t.Hf.TARGET_TEST_CAPTAIN_FALCON,name:"Target Test (Captain Falcon)"}),E(a,t.Hf.TARGET_TEST_YOUNG_LINK,{id:t.Hf.TARGET_TEST_YOUNG_LINK,name:"Target Test (Young Link)"}),E(a,t.Hf.TARGET_TEST_DONKEY_KONG,{id:t.Hf.TARGET_TEST_DONKEY_KONG,name:"Target Test (Donkey Kong)"}),E(a,t.Hf.TARGET_TEST_DR_MARIO,{id:t.Hf.TARGET_TEST_DR_MARIO,name:"Target Test (Dr. Mario)"}),E(a,t.Hf.TARGET_TEST_FALCO,{id:t.Hf.TARGET_TEST_FALCO,name:"Target Test (Falco)"}),E(a,t.Hf.TARGET_TEST_FOX,{id:t.Hf.TARGET_TEST_FOX,name:"Target Test (Fox)"}),E(a,t.Hf.TARGET_TEST_ICE_CLIMBERS,{id:t.Hf.TARGET_TEST_ICE_CLIMBERS,name:"Target Test (Ice Climbers)"}),E(a,t.Hf.TARGET_TEST_KIRBY,{id:t.Hf.TARGET_TEST_KIRBY,name:"Target Test (Kirby)"}),E(a,t.Hf.TARGET_TEST_BOWSER,{id:t.Hf.TARGET_TEST_BOWSER,name:"Target Test (Bowser)"}),E(a,t.Hf.TARGET_TEST_LINK,{id:t.Hf.TARGET_TEST_LINK,name:"Target Test (Link)"}),E(a,t.Hf.TARGET_TEST_LUIGI,{id:t.Hf.TARGET_TEST_LUIGI,name:"Target Test (Luigi)"}),E(a,t.Hf.TARGET_TEST_MARTH,{id:t.Hf.TARGET_TEST_MARTH,name:"Target Test (Marth)"}),E(a,t.Hf.TARGET_TEST_MEWTWO,{id:t.Hf.TARGET_TEST_MEWTWO,name:"Target Test (Mewtwo)"}),E(a,t.Hf.TARGET_TEST_NESS,{id:t.Hf.TARGET_TEST_NESS,name:"Target Test (Ness)"}),E(a,t.Hf.TARGET_TEST_PEACH,{id:t.Hf.TARGET_TEST_PEACH,name:"Target Test (Peach)"}),E(a,t.Hf.TARGET_TEST_PICHU,{id:t.Hf.TARGET_TEST_PICHU,name:"Target Test (Pichu)"}),E(a,t.Hf.TARGET_TEST_PIKACHU,{id:t.Hf.TARGET_TEST_PIKACHU,name:"Target Test (Pikachu)"}),E(a,t.Hf.TARGET_TEST_JIGGLYPUFF,{id:t.Hf.TARGET_TEST_JIGGLYPUFF,name:"Target Test (Jigglypuff)"}),E(a,t.Hf.TARGET_TEST_SAMUS,{id:t.Hf.TARGET_TEST_SAMUS,name:"Target Test (Samus)"}),E(a,t.Hf.TARGET_TEST_SHEIK,{id:t.Hf.TARGET_TEST_SHEIK,name:"Target Test (Sheik)"}),E(a,t.Hf.TARGET_TEST_YOSHI,{id:t.Hf.TARGET_TEST_YOSHI,name:"Target Test (Yoshi)"}),E(a,t.Hf.TARGET_TEST_ZELDA,{id:t.Hf.TARGET_TEST_ZELDA,name:"Target Test (Zelda)"}),E(a,t.Hf.TARGET_TEST_GAME_AND_WATCH,{id:t.Hf.TARGET_TEST_GAME_AND_WATCH,name:"Target Test (Mr. Game & Watch)"}),E(a,t.Hf.TARGET_TEST_ROY,{id:t.Hf.TARGET_TEST_ROY,name:"Target Test (Roy)"}),E(a,t.Hf.TARGET_TEST_GANONDORF,{id:t.Hf.TARGET_TEST_GANONDORF,name:"Target Test (Ganondorf)"}),E(a,t.Hf.HOME_RUN_CONTEST,{id:t.Hf.HOME_RUN_CONTEST,name:"Home-Run Contest"}),a);function k(e){return L[e]||H}var U,B={__proto__:null,UnknownStage:H,getStageInfo:k,getStageName:function(e){return k(e).name}};t.ZM=void 0,(U=t.ZM||(t.ZM={}))[U.DAMAGE_START=75]="DAMAGE_START",U[U.DAMAGE_END=91]="DAMAGE_END",U[U.CAPTURE_START=223]="CAPTURE_START",U[U.CAPTURE_END=232]="CAPTURE_END",U[U.GUARD_START=178]="GUARD_START",U[U.GUARD_END=182]="GUARD_END",U[U.GROUNDED_CONTROL_START=14]="GROUNDED_CONTROL_START",U[U.GROUNDED_CONTROL_END=24]="GROUNDED_CONTROL_END",U[U.SQUAT_START=39]="SQUAT_START",U[U.SQUAT_END=41]="SQUAT_END",U[U.DOWN_START=183]="DOWN_START",U[U.DOWN_END=198]="DOWN_END",U[U.TECH_START=199]="TECH_START",U[U.TECH_END=204]="TECH_END",U[U.DYING_START=0]="DYING_START",U[U.DYING_END=10]="DYING_END",U[U.CONTROLLED_JUMP_START=24]="CONTROLLED_JUMP_START",U[U.CONTROLLED_JUMP_END=34]="CONTROLLED_JUMP_END",U[U.GROUND_ATTACK_START=44]="GROUND_ATTACK_START",U[U.GROUND_ATTACK_END=64]="GROUND_ATTACK_END",U[U.AERIAL_ATTACK_START=65]="AERIAL_ATTACK_START",U[U.AERIAL_ATTACK_END=74]="AERIAL_ATTACK_END",U[U.ROLL_FORWARD=233]="ROLL_FORWARD",U[U.ROLL_BACKWARD=234]="ROLL_BACKWARD",U[U.SPOT_DODGE=235]="SPOT_DODGE",U[U.AIR_DODGE=236]="AIR_DODGE",U[U.ACTION_WAIT=14]="ACTION_WAIT",U[U.ACTION_DASH=20]="ACTION_DASH",U[U.ACTION_KNEE_BEND=24]="ACTION_KNEE_BEND",U[U.GUARD_ON=178]="GUARD_ON",U[U.TECH_MISS_UP=183]="TECH_MISS_UP",U[U.TECH_MISS_DOWN=191]="TECH_MISS_DOWN",U[U.NEUTRAL_TECH=199]="NEUTRAL_TECH",U[U.FORWARD_TECH=200]="FORWARD_TECH",U[U.BACKWARD_TECH=201]="BACKWARD_TECH",U[U.WALL_TECH=202]="WALL_TECH",U[U.MISSED_WALL_TECH=247]="MISSED_WALL_TECH",U[U.DASH=20]="DASH",U[U.TURN=18]="TURN",U[U.LANDING_FALL_SPECIAL=43]="LANDING_FALL_SPECIAL",U[U.JUMP_FORWARD=25]="JUMP_FORWARD",U[U.JUMP_BACKWARD=26]="JUMP_BACKWARD",U[U.FALL_FORWARD=30]="FALL_FORWARD",U[U.FALL_BACKWARD=31]="FALL_BACKWARD",U[U.GRAB=212]="GRAB",U[U.GRAB_WAIT=216]="GRAB_WAIT",U[U.PUMMEL=217]="PUMMEL",U[U.CLIFF_CATCH=252]="CLIFF_CATCH",U[U.THROW_UP=221]="THROW_UP",U[U.THROW_FORWARD=219]="THROW_FORWARD",U[U.THROW_DOWN=222]="THROW_DOWN",U[U.THROW_BACK=220]="THROW_BACK",U[U.DAMAGE_FALL=38]="DAMAGE_FALL",U[U.BARREL_WAIT=293]="BARREL_WAIT",U[U.COMMAND_GRAB_RANGE1_START=266]="COMMAND_GRAB_RANGE1_START",U[U.COMMAND_GRAB_RANGE1_END=304]="COMMAND_GRAB_RANGE1_END",U[U.COMMAND_GRAB_RANGE2_START=327]="COMMAND_GRAB_RANGE2_START",U[U.COMMAND_GRAB_RANGE2_END=338]="COMMAND_GRAB_RANGE2_END";var P={PUNISH_RESET_FRAMES:45,RECOVERY_RESET_FRAMES:45,COMBO_STRING_RESET_FRAMES:45};function w(e){return e&&2===e.players.length?[{playerIndex:e.players[0].playerIndex,opponentIndex:e.players[1].playerIndex},{playerIndex:e.players[1].playerIndex,opponentIndex:e.players[0].playerIndex}]:[]}function b(e,t){return!(!e||!t)&&t.stocksRemaining-e.stocksRemaining>0}function W(e){var n=e>=t.ZM.GROUNDED_CONTROL_START&&e<=t.ZM.GROUNDED_CONTROL_END,a=e>=t.ZM.SQUAT_START&&e<=t.ZM.SQUAT_END,r=e>t.ZM.GROUND_ATTACK_START&&e<=t.ZM.GROUND_ATTACK_END,i=e===t.ZM.GRAB;return n||a||r||i}function Y(e){return e>=t.ZM.TECH_START&&e<=t.ZM.TECH_END}function K(e){return e>=t.ZM.DOWN_START&&e<=t.ZM.DOWN_END}function x(e){return e>=t.ZM.DAMAGE_START&&e<=t.ZM.DAMAGE_END||e===t.ZM.DAMAGE_FALL}function Z(e){return e>=t.ZM.CAPTURE_START&&e<=t.ZM.CAPTURE_END}function z(e){return(e>=t.ZM.COMMAND_GRAB_RANGE1_START&&e<=t.ZM.COMMAND_GRAB_RANGE1_END||e>=t.ZM.COMMAND_GRAB_RANGE2_START&&e<=t.ZM.COMMAND_GRAB_RANGE2_END)&&e!==t.ZM.BARREL_WAIT}function J(e){return e>=t.ZM.DYING_START&&e<=t.ZM.DYING_END}function X(e,t){var n,a;return(null!=(n=e.percent)?n:0)-(null!=(a=t.percent)?a:0)}var j,V,Q,q,$,ee=[t.ZM.DASH,t.ZM.TURN,t.ZM.DASH],te=function(){function e(){u(this,e),this.playerPermutations=new Array,this.state=new Map}return T(e,[{key:"setup",value:function(e){var t=this;this.state=new Map,this.playerPermutations=w(e),this.playerPermutations.forEach((function(e){t.state.set(e,{playerCounts:{playerIndex:e.playerIndex,wavedashCount:0,wavelandCount:0,airDodgeCount:0,dashDanceCount:0,spotDodgeCount:0,ledgegrabCount:0,rollCount:0,lCancelCount:{success:0,fail:0},grabCount:{success:0,fail:0},throwCount:{up:0,forward:0,back:0,down:0},groundTechCount:{away:0,in:0,neutral:0,fail:0},wallTechCount:{success:0,fail:0}},animations:[]})}))}},{key:"processFrame",value:function(e){var n=this;this.playerPermutations.forEach((function(a){var r=n.state.get(a);r&&function(e,n,a){var r=a.players[n.playerIndex].post,i=a.players[n.opponentIndex].post,s=function(t,n){if(n){var a=c.get(e.playerCounts,t,0);c.set(e.playerCounts,t,a+1)}},o=r.actionStateId;e.animations.push(o);var l=e.animations.slice(-3),u=l[l.length-2],T=o!==u;s("dashDanceCount",c.isEqual(l,ee));var E=function(e,t){var n=ne(e),a=ne(t);return n&&!a}(o,u);s("rollCount",E);var _=function(e,t){var n=ae(e),a=ae(t);return n&&!a}(o,u);s("spotDodgeCount",_);var A=function(e,t){var n=re(e),a=re(t);return n&&!a}(o,u);s("airDodgeCount",A);var f=function(e,t){var n=ie(e),a=ie(t);return n&&!a}(o,u);s("ledgegrabCount",f);var m=function(e,n){return n===t.ZM.GRAB&&e<=t.ZM.GRAB_WAIT&&e>t.ZM.GRAB}(o,u);s("grabCount.success",m);var R,d=function(e,n){return n===t.ZM.GRAB&&(e>t.ZM.GRAB_WAIT||e<t.ZM.GRAB)}(o,u);if(s("grabCount.fail",d),s("throwCount.up",o===t.ZM.THROW_UP&&T),s("throwCount.forward",o===t.ZM.THROW_FORWARD&&T),s("throwCount.down",o===t.ZM.THROW_DOWN&&T),s("throwCount.back",o===t.ZM.THROW_BACK&&T),T){s("groundTechCount.fail",(R=o)===t.ZM.TECH_MISS_DOWN||R===t.ZM.TECH_MISS_UP);var h=1,S=!1;r.positionX>i.positionX&&(h=-1),r.facingDirection==h&&(S=!0),s("groundTechCount.in",o===t.ZM.FORWARD_TECH&&S),s("groundTechCount.in",o===t.ZM.BACKWARD_TECH&&!S),s("groundTechCount.neutral",o===t.ZM.NEUTRAL_TECH),s("groundTechCount.away",o===t.ZM.BACKWARD_TECH&&S),s("groundTechCount.away",o===t.ZM.FORWARD_TECH&&!S),s("wallTechCount.success",o===t.ZM.WALL_TECH),s("wallTechCount.fail",o===t.ZM.MISSED_WALL_TECH)}(function(e){return e>=t.ZM.AERIAL_ATTACK_START&&e<=t.ZM.AERIAL_ATTACK_END})(o)&&(s("lCancelCount.success",1===r.lCancelStatus),s("lCancelCount.fail",2===r.lCancelStatus)),function(e,n){var a=c.last(n)===t.ZM.LANDING_FALL_SPECIAL,r=function(e){if(e===t.ZM.AIR_DODGE)return!0;var n=e>=t.ZM.CONTROLLED_JUMP_START,a=e<=t.ZM.CONTROLLED_JUMP_END;return n&&a}(n[n.length-2]);if(a&&r){var i=n.slice(-8),s=c.keyBy(i,(function(e){return e}));2===c.size(s)&&s[t.ZM.AIR_DODGE]||(s[t.ZM.AIR_DODGE]&&(e.airDodgeCount-=1),s[t.ZM.ACTION_KNEE_BEND]?e.wavedashCount+=1:e.wavelandCount+=1)}}(e.playerCounts,e.animations)}(r,a,e)}))}},{key:"fetch",value:function(){return Array.from(this.state.values()).map((function(e){return e.playerCounts}))}}]),e}();function ne(e){return e===t.ZM.ROLL_BACKWARD||e===t.ZM.ROLL_FORWARD}function ae(e){return e===t.ZM.SPOT_DODGE}function re(e){return e===t.ZM.AIR_DODGE}function ie(e){return e===t.ZM.CLIFF_CATCH}!function(e){e.COMBO_START="COMBO_START",e.COMBO_EXTEND="COMBO_EXTEND",e.COMBO_END="COMBO_END"}(j||(j={}));var se=function(e){o(n,e);var t=l(n);function n(){var e;u(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).playerPermutations=new Array,e.state=new Map,e.last_combo={playerIndex:0,moves:[],didKill:!1,lastHitBy:null,startFrame:0,endFrame:null,startPercent:0,currentPercent:0,endPercent:null},e.settings=null,e}return T(n,[{key:"setup",value:function(e){var t=this;this.state=new Map,this.playerPermutations=w(e),this.playerPermutations.forEach((function(e){t.state.set(e,{combo:null,move:null,resetCounter:0,lastHitAnimation:null,event:null})}))}},{key:"processFrame",value:function(e,t){var n=this;this.playerPermutations.forEach((function(a){var r=n.state.get(a);r&&(function(e,t,n,a){var r=a.frame,i=a.players[n.playerIndex].post,s=a.players[n.opponentIndex].post,o=r-1,l=null,u=null;e[o]&&(l=e[o].players[n.playerIndex].post,u=e[o].players[n.opponentIndex].post);var T=s.actionStateId,E=x(T),c=Z(T),_=z(T),A=u?X(s,u):0;if((i.actionStateId!==t.lastHitAnimation||i.actionStateCounter<(l?l.actionStateCounter:0))&&(t.lastHitAnimation=null),E||c||_){var f,m,R=!1;t.combo||(t.combo={playerIndex:n.opponentIndex,startFrame:r,endFrame:null,startPercent:u&&null!=(f=u.percent)?f:0,currentPercent:null!=(m=s.percent)?m:0,endPercent:null,moves:[],didKill:!1,lastHitBy:n.playerIndex},R=!0),A&&(null===t.lastHitAnimation&&(t.move={playerIndex:n.playerIndex,frame:r,moveId:i.lastAttackLanded,hitCount:0,damage:0},t.combo.moves.push(t.move),R||(t.event=j.COMBO_EXTEND)),t.move&&(t.move.hitCount+=1,t.move.damage+=A),t.lastHitAnimation=l?l.actionStateId:null),R&&(t.event=j.COMBO_START)}if(t.combo){var d,h=Y(T),S=K(T),p=u&&b(s,u),I=J(T);p||(t.combo.currentPercent=null!=(d=s.percent)?d:0),E||c||_||h||S||I?t.resetCounter=0:t.resetCounter+=1;var N,C=!1;p&&(t.combo.didKill=!0,C=!0),t.resetCounter>P.COMBO_STRING_RESET_FRAMES&&(C=!0),C&&(t.combo.endFrame=i.frame,t.combo.endPercent=u&&null!=(N=u.percent)?N:0,t.event=j.COMBO_END,t.combo=null,t.move=null)}}(t,r,a,e),"COMBO_START"===r.event&&r.combo&&(n.last_combo=r.combo),null!==r.event&&(n.emit(r.event,{last_combo:n.last_combo,settings:n.settings}),r.event=null))}))}},{key:"fetch",value:function(){return this.last_combo}}]),n}(_.EventEmitter),oe=function(e){o(n,e);var t=l(n);function n(){var e;return u(this,n),(e=t.call(this)).playerPermutations=new Array,e.conversions=new Array,e.state=new Map,e.metadata=void 0,e.settings=null,e.metadata={lastEndFrameByOppIdx:{}},e}return T(n,[{key:"setup",value:function(e){var t=this;this.playerPermutations=w(e),this.conversions=[],this.state=new Map,this.metadata={lastEndFrameByOppIdx:{}},this.settings=e,this.playerPermutations.forEach((function(e){t.state.set(e,{conversion:null,move:null,resetCounter:0,lastHitAnimation:null})}))}},{key:"processFrame",value:function(e,t){var n=this;this.playerPermutations.forEach((function(a){var r=n.state.get(a);if(r){var i=function(e,t,n,a,r){var i=a.frame,s=a.players[n.playerIndex].post,o=a.players[n.opponentIndex].post,l=i-1,u=null,T=null;e[l]&&(u=e[l].players[n.playerIndex].post,T=e[l].players[n.opponentIndex].post);var E,c,_=o.actionStateId,A=x(_),f=Z(_),m=z(_),R=T?X(o,T):0;if((s.actionStateId!==t.lastHitAnimation||s.actionStateCounter<(u?u.actionStateCounter:0))&&(t.lastHitAnimation=null),(A||f||m)&&(t.conversion||(t.conversion={playerIndex:n.opponentIndex,lastHitBy:n.playerIndex,startFrame:i,endFrame:null,startPercent:T&&null!=(E=T.percent)?E:0,currentPercent:null!=(c=o.percent)?c:0,endPercent:null,moves:[],didKill:!1,openingType:"unknown"},r.push(t.conversion)),R&&(null===t.lastHitAnimation&&(t.move={playerIndex:n.playerIndex,frame:i,moveId:s.lastAttackLanded,hitCount:0,damage:0},t.conversion.moves.push(t.move)),t.move&&(t.move.hitCount+=1,t.move.damage+=R),t.lastHitAnimation=u?u.actionStateId:null)),!t.conversion)return!1;var d,h=W(_),S=T&&b(o,T);S||(t.conversion.currentPercent=null!=(d=o.percent)?d:0),(A||f||m)&&(t.resetCounter=0),(0===t.resetCounter&&h||t.resetCounter>0)&&(t.resetCounter+=1);var p,I=!1;return S&&(t.conversion.didKill=!0,I=!0),t.resetCounter>P.PUNISH_RESET_FRAMES&&(I=!0),I&&(t.conversion.endFrame=s.frame,t.conversion.endPercent=T&&null!=(p=T.percent)?p:0,t.conversion=null,t.move=null),I}(t,r,a,e,n.conversions);i&&n.emit("CONVERSION",{combo:c.last(n.conversions),settings:n.settings})}}))}},{key:"fetch",value:function(){return this._populateConversionTypes(),this.conversions}},{key:"_populateConversionTypes",value:function(){var e=this,t=c.filter(this.conversions,(function(e){return"unknown"===e.openingType})),n=c.groupBy(t,"startFrame");c.orderBy(n,(function(e){return c.get(e,[0,"startFrame"])})).forEach((function(t){var n=t.length>=2;t.forEach((function(t){if(e.metadata.lastEndFrameByOppIdx[t.playerIndex]=t.endFrame,n)t.openingType="trade";else{var a=c.last(t.moves),r=e.metadata.lastEndFrameByOppIdx[a?a.playerIndex:t.playerIndex];t.openingType=r&&r>t.startFrame?"counter-attack":"neutral-win"}}))}))}}]),n}(_.EventEmitter);t.mY=void 0,(V=t.mY||(t.mY={}))[V.MESSAGE_SIZES=53]="MESSAGE_SIZES",V[V.GAME_START=54]="GAME_START",V[V.PRE_FRAME_UPDATE=55]="PRE_FRAME_UPDATE",V[V.POST_FRAME_UPDATE=56]="POST_FRAME_UPDATE",V[V.GAME_END=57]="GAME_END",V[V.ITEM_UPDATE=59]="ITEM_UPDATE",V[V.FRAME_BOOKEND=60]="FRAME_BOOKEND",t.GF=void 0,(Q=t.GF||(t.GF={}))[Q.VS=2]="VS",Q[Q.ONLINE=8]="ONLINE",t.IX=void 0,(q=t.IX||(t.IX={}))[q.FIRST=-123]="FIRST",q[q.FIRST_PLAYABLE=-39]="FIRST_PLAYABLE",function(e){e[e.DZ=0]="DZ",e[e.NE=1]="NE",e[e.SE=2]="SE",e[e.SW=3]="SW",e[e.NW=4]="NW",e[e.N=5]="N",e[e.E=6]="E",e[e.S=7]="S",e[e.W=8]="W"}($||($={}));var le=function(){function e(){u(this,e),this.state=new Map,this.playerPermutations=new Array}return T(e,[{key:"setup",value:function(e){var t=this;this.state=new Map,this.playerPermutations=w(e),this.playerPermutations.forEach((function(e){t.state.set(e,{playerIndex:e.playerIndex,opponentIndex:e.opponentIndex,inputCount:0,joystickInputCount:0,cstickInputCount:0,buttonInputCount:0,triggerInputCount:0})}))}},{key:"processFrame",value:function(e,n){var a=this;this.playerPermutations.forEach((function(r){var i=a.state.get(r);i&&function(e,n,a,r){var i=r.players[a.playerIndex].pre,s=i.frame,o=s-1,l=e[o]?e[o].players[a.playerIndex].pre:null;if(!(s<t.IX.FIRST_PLAYABLE)&&l){var u=~l.physicalButtons,T=i.physicalButtons;n.pressing_start=!!(4096&T),n.airborne=!!r.players[a.playerIndex].post.isAirborne;var E=function(e){var t,n=e;for(t=0;n;t+=1)n&=n-1;return t}(u&T&4095);n.inputCount+=E,n.buttonInputCount+=E;var c=ue(l.joystickX,l.joystickY),_=ue(i.joystickX,i.joystickY);c!==_&&_!==$.DZ&&(n.inputCount+=1,n.joystickInputCount+=1);var A=ue(l.cStickX,l.cStickY),f=ue(i.cStickX,i.cStickY);A!==f&&f!==$.DZ&&(n.inputCount+=1,n.cstickInputCount+=1),l.physicalLTrigger<.3&&i.physicalLTrigger>=.3&&(n.inputCount+=1,n.triggerInputCount+=1),l.physicalRTrigger<.3&&i.physicalRTrigger>=.3&&(n.inputCount+=1,n.triggerInputCount+=1)}}(n,i,r,e)}))}},{key:"fetch",value:function(){return Array.from(this.state.values())}}]),e}();function ue(e,t){var n=$.DZ;return e>=.2875&&t>=.2875?n=$.NE:e>=.2875&&t<=-.2875?n=$.SE:e<=-.2875&&t<=-.2875?n=$.SW:e<=-.2875&&t>=.2875?n=$.NW:t>=.2875?n=$.N:e>=.2875?n=$.E:t<=-.2875?n=$.S:e<=-.2875&&(n=$.W),n}function Te(e){var t=e.settings,n=e.inputs,a=e.conversions,r=e.playableFrameCount,i=c.keyBy(n,"playerIndex"),s=a,o=c.groupBy(a,(function(e){var t;return null==(t=e.moves[0])?void 0:t.playerIndex})),l=c.mapValues(o,(function(e){return c.groupBy(e,"openingType")})),u=r/3600;return t.players.map((function(e){var n=e.playerIndex,a=c.get(i,n)||{},r={buttons:c.get(a,"buttonInputCount"),triggers:c.get(a,"triggerInputCount"),cstick:c.get(a,"cstickInputCount"),joystick:c.get(a,"joystickInputCount"),total:c.get(a,"inputCount")},o=0,T=t.players.filter((function(a){return a.playerIndex!==n&&(!t.isTeams||a.teamId!==e.teamId)})).map((function(e){return e.playerIndex})),E=0,_=0;return s.filter((function(e){return e.playerIndex!==n})).forEach((function(e){o++,e.didKill&&e.lastHitBy===n&&(_+=1),e.moves.forEach((function(e){e.playerIndex===n&&(E+=e.damage)}))})),{playerIndex:n,totalDamage:E,killCount:_,inputsPerMinute:Ee(r.total,u),openingsPerKill:Ee(o,_),damagePerOpening:Ee(E,o),neutralWinRatio:ce(l,n,T,"neutral-win")}}))}function Ee(e,t){return{count:e,total:t,ratio:t?e/t:null}}function ce(e,t,n,a){var r=c.get(e,[t,a])||[],i=c.flatten(n.map((function(t){return c.get(e,[t,a])||[]})));return Ee(r.length,r.length+i.length)}var _e={processOnTheFly:!1},Ae=function(){function e(t){u(this,e),this.options=void 0,this.lastProcessedFrame=null,this.frames={},this.players=[],this.allComputers=new Array,this.options=Object.assign({},_e,t)}return T(e,[{key:"setup",value:function(e){this.frames={},this.players=e.players.map((function(e){return e.playerIndex})),this.allComputers.forEach((function(t){return t.setup(e)}))}},{key:"register",value:function(){var e;(e=this.allComputers).push.apply(e,arguments)}},{key:"process",value:function(){var e=this;if(0!==this.players.length)for(var n=null!==this.lastProcessedFrame?this.lastProcessedFrame+1:t.IX.FIRST,a=function(){var t=e.frames[n];if(!fe(e.players,t))return{v:void 0};e.allComputers.forEach((function(n){return n.processFrame(t,e.frames)})),e.lastProcessedFrame=n,n++};this.frames[n];){var r=a();if("object"===typeof r)return r.v}}},{key:"addFrame",value:function(e){this.frames[e.frame]=e,this.options.processOnTheFly&&this.process()}}]),e}();function fe(e,t){if(!t)return!1;var n,a=s(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(!c.get(t,["players",r,"post"]))return!1}}catch(i){a.e(i)}finally{a.f()}return!0}var me,Re=function(){function e(){u(this,e),this.state=new Map,this.playerPermutations=new Array,this.stocks=new Array}return T(e,[{key:"setup",value:function(e){var t=this;this.state=new Map,this.playerPermutations=w(e),this.stocks=[],this.playerPermutations.forEach((function(e){t.state.set(e,{stock:null})}))}},{key:"processFrame",value:function(e,t){var n=this;this.playerPermutations.forEach((function(a){var r=n.state.get(a);r&&function(e,t,n,a,r){var i=a.players[n.playerIndex].post,s=i.frame,o=s-1,l=e[o]?e[o].players[n.playerIndex].post:null;if(t.stock){var u,T;if(l&&b(i,l))t.stock.endFrame=i.frame,t.stock.endPercent=null!=(u=l.percent)?u:0,t.stock.deathAnimation=i.actionStateId,t.stock=null;else t.stock.currentPercent=null!=(T=i.percent)?T:0}else{if(J(i.actionStateId))return;t.stock={playerIndex:n.playerIndex,startFrame:s,endFrame:null,startPercent:0,endPercent:null,currentPercent:0,count:i.stocksRemaining,deathAnimation:null},r.push(t.stock)}}(t,r,a,e,n.stocks)}))}},{key:"fetch",value:function(){return this.stocks}}]),e}();function de(e){var t=I.default.map(e,(function(e){return(t=e.charCodeAt(0))>65280&&t<65375?t-65280+32:12288===t?32:8217===t?39:8221===t?34:t;var t}));return String.fromCharCode.apply(String,i(t))}!function(e){e.BUFFER="buffer",e.FILE="file"}(me||(me={}));var he,Se=function(e){if(e.source===me.BUFFER)return{source:e.source,buffer:e.buffer};throw new Error("Source type not supported")},pe=function(e,t,n){if(e.source===me.BUFFER)return e.buffer.slice(n,n+t);throw new Error("Source type not supported")},Ie=function(e){if(e.source===me.BUFFER)return e.buffer.length;throw new Error("Source type not supported")};!function(e){e.BUFFER="buffer",e.FILE="file"}(he||(he={}));var Ne,Ce=function(e){return m.convert(e,{to:"UNICODE",from:"SJIS",type:"string"}).split("\0").shift()};function Oe(e,n){var a=n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength),r=new DataView(a);switch(e){case t.mY.GAME_START:return{slpVersion:"".concat(Fe(r,1),".").concat(Fe(r,2),".").concat(Fe(r,3)),isTeams:He(r,13),isPAL:He(r,417),stageId:ye(r,19),players:[0,1,2,3].map((function(e){var t=8*e,a=ve(r,321+t),i="None";a!==ve(r,325+t)?i="Mixed":1===a?i="UCF":2===a&&(i="Dween");var s=353+16*e,o=n.slice(s,s+16),l=Ce(o),u=l?de(l):"",T=421+31*e,E=n.slice(T,T+31),c=Ce(E),_=c?de(c):"",A=545+10*e,f=n.slice(A,A+10),m=Ce(f),R=m?de(m):"",d=36*e;return{playerIndex:e,port:e+1,characterId:Fe(r,101+d),characterColor:Fe(r,104+d),startStocks:Fe(r,103+d),type:Fe(r,102+d),teamId:Fe(r,110+d),controllerFix:i,nametag:u,displayName:_,connectCode:R}})),scene:Fe(r,419),gameMode:Fe(r,420)};case t.mY.PRE_FRAME_UPDATE:return{frame:Me(r,1),playerIndex:Fe(r,5),isFollower:He(r,6),seed:ve(r,7),actionStateId:ye(r,11),positionX:Ge(r,13),positionY:Ge(r,17),facingDirection:Ge(r,21),joystickX:Ge(r,25),joystickY:Ge(r,29),cStickX:Ge(r,33),cStickY:Ge(r,37),trigger:Ge(r,41),buttons:ve(r,45),physicalButtons:ye(r,49),physicalLTrigger:Ge(r,51),physicalRTrigger:Ge(r,55),percent:Ge(r,60)};case t.mY.POST_FRAME_UPDATE:var i={airX:Ge(r,53),y:Ge(r,57),attackX:Ge(r,61),attackY:Ge(r,65),groundX:Ge(r,69)};return{frame:Me(r,1),playerIndex:Fe(r,5),isFollower:He(r,6),internalCharacterId:Fe(r,7),actionStateId:ye(r,8),positionX:Ge(r,10),positionY:Ge(r,14),facingDirection:Ge(r,18),percent:Ge(r,22),shieldSize:Ge(r,26),lastAttackLanded:Fe(r,30),currentComboCount:Fe(r,31),lastHitBy:Fe(r,32),stocksRemaining:Fe(r,33),actionStateCounter:Ge(r,34),miscActionState:Ge(r,43),isAirborne:He(r,47),lastGroundId:ye(r,48),jumpsRemaining:Fe(r,50),lCancelStatus:Fe(r,51),hurtboxCollisionState:Fe(r,52),selfInducedSpeeds:i};case t.mY.ITEM_UPDATE:return{frame:Me(r,1),typeId:ye(r,5),state:Fe(r,7),facingDirection:Ge(r,8),velocityX:Ge(r,12),velocityY:Ge(r,16),positionX:Ge(r,20),positionY:Ge(r,24),damageTaken:ye(r,28),expirationTimer:Ge(r,30),spawnId:ve(r,34),missileType:Fe(r,38),turnipFace:Fe(r,39),chargeShotLaunched:Fe(r,40),chargePower:Fe(r,41),owner:ge(r,42)};case t.mY.FRAME_BOOKEND:return{frame:Me(r,1),latestFinalizedFrame:Me(r,5)};case t.mY.GAME_END:return{gameEndMethod:Fe(r,1),lrasInitiatorIndex:ge(r,2)};default:return null}}function De(e,t,n){return t+n<=e.byteLength}function Ge(e,t){return De(e,t,4)?e.getFloat32(t):null}function Me(e,t){return De(e,t,4)?e.getInt32(t):null}function ge(e,t){return De(e,t,1)?e.getInt8(t):null}function ve(e,t){return De(e,t,4)?e.getUint32(t):null}function ye(e,t){return De(e,t,2)?e.getUint16(t):null}function Fe(e,t){return De(e,t,1)?e.getUint8(t):null}function He(e,t){return De(e,t,1)?!!e.getUint8(t):null}!function(e){e.AUTO="AUTO",e.MANUAL="MANUAL"}(Ne||(Ne={}));var Le,ke={suppressErrors:!1,mode:Ne.AUTO};!function(e){e.RAW="slp-raw",e.COMMAND="slp-command"}(Le||(Le={}));var Ue,Be=function(e){o(a,e);var n=l(a);function a(e,t){var r;return u(this,a),(r=n.call(this,t)).gameEnded=!1,r.settings=void 0,r.payloadSizes=null,r.previousBuffer=Buffer.from([]),r.settings=Object.assign({},ke,e),r}return T(a,[{key:"restart",value:function(){this.gameEnded=!1,this.payloadSizes=null}},{key:"_write",value:function(e,t,n){if("buffer"!==t)throw new Error("Unsupported stream encoding. Expected 'buffer' got '".concat(t,"'."));var a=Uint8Array.from(Buffer.concat([this.previousBuffer,e]));this.previousBuffer=Buffer.from([]);for(var r=new DataView(a.buffer),i=0;i<a.length;)if("HELO\0"!==Buffer.from(a.slice(i,i+5)).toString()){var s,o=r.getUint8(i),l=0;if(this.payloadSizes&&(l=null!=(s=this.payloadSizes.get(o))?s:0),a.length-i<l+1){this.previousBuffer=a.slice(i);break}if(this.settings.mode===Ne.MANUAL&&this.gameEnded)break;i+=1;var u=a.slice(i),T=new DataView(a.buffer,i),E=0;try{E=this._processCommand(o,u,T)}catch(e){if(!this.settings.suppressErrors)throw e;E=0}i+=E}else i+=5;n()}},{key:"_writeCommand",value:function(e,t,n){var a=t.slice(0,n),r=Buffer.concat([Buffer.from([e]),a]);return this.emit(Le.RAW,{command:e,payload:r}),new Uint8Array(r)}},{key:"_processCommand",value:function(e,n,a){if(e===t.mY.MESSAGE_SIZES){var r=a.getUint8(0);return this.payloadSizes=Pe(a),this._writeCommand(e,n,r),this.emit(Le.COMMAND,{command:e,payload:this.payloadSizes}),r}var i,s=0;this.payloadSizes&&(s=null!=(i=this.payloadSizes.get(e))?i:0);var o=null;return s>0&&(o=Oe(e,this._writeCommand(e,n,s))),o?(e===t.mY.GAME_END&&this.settings.mode===Ne.MANUAL&&(this.gameEnded=!0),this.emit(Le.COMMAND,{command:e,payload:o}),s):s}}]),a}(f.Writable),Pe=function(e){for(var t=new Map,n=e.getUint8(0),a=1;a<n;a+=3){var r=e.getUint8(a),i=e.getUint16(a+1);t.set(r,i)}return t},we=function(e){var t=Buffer.alloc(4);return t.writeInt32BE(e,0),t},be=function(e){var t=Buffer.alloc(4);return t.writeUInt32BE(e,0),t},We=function(){function e(){u(this,e),this.rollbackFrames={},this.rollbackFrameCount=0,this.rollbackPlayerIdx=null,this.lastFrameWasRollback=!1,this.currentRollbackLength=0,this.rollbackLengths=[]}return T(e,[{key:"checkIfRollbackFrame",value:function(e,t){if(null===this.rollbackPlayerIdx)this.rollbackPlayerIdx=t;else if(this.rollbackPlayerIdx!==t)return;return e?(this.rollbackFrames[e.frame]?this.rollbackFrames[e.frame].push(e):this.rollbackFrames[e.frame]=[e],this.rollbackFrameCount++,this.currentRollbackLength++,this.lastFrameWasRollback=!0):this.lastFrameWasRollback&&(this.rollbackLengths.push(this.currentRollbackLength),this.currentRollbackLength=0,this.lastFrameWasRollback=!1),this.lastFrameWasRollback}},{key:"getFrames",value:function(){return this.rollbackFrames}},{key:"getCount",value:function(){return this.rollbackFrameCount}},{key:"getLengths",value:function(){return this.rollbackLengths}}]),e}();t.zo=void 0,(Ue=t.zo||(t.zo={})).SETTINGS="settings",Ue.END="end",Ue.FRAME="frame",Ue.FINALIZED_FRAME="finalized-frame",Ue.ROLLBACK_FRAME="rollback-frame";var Ye={strict:!1},Ke=function(e){o(a,e);var n=l(a);function a(e){var r;return u(this,a),(r=n.call(this)).frames={},r.rollbackCounter=new We,r.settings=null,r.gameEnd=null,r.latestFrameIndex=null,r.settingsComplete=!1,r.lastFinalizedFrame=t.IX.FIRST-1,r.options=void 0,r.options=Object.assign({},Ye,e),r}return T(a,[{key:"handleCommand",value:function(e,n){switch(e){case t.mY.GAME_START:this._handleGameStart(n);break;case t.mY.POST_FRAME_UPDATE:this._handlePostFrameUpdate(n),this._handleFrameUpdate(e,n);break;case t.mY.PRE_FRAME_UPDATE:this._handleFrameUpdate(e,n);break;case t.mY.ITEM_UPDATE:this._handleItemUpdate(n);break;case t.mY.FRAME_BOOKEND:this._handleFrameBookend(n);break;case t.mY.GAME_END:this._handleGameEnd(n)}}},{key:"reset",value:function(){this.frames={},this.settings=null,this.gameEnd=null,this.latestFrameIndex=null,this.settingsComplete=!1,this.lastFinalizedFrame=t.IX.FIRST-1}},{key:"getLatestFrameNumber",value:function(){var e;return null!=(e=this.latestFrameIndex)?e:t.IX.FIRST-1}},{key:"getPlayableFrameCount",value:function(){return null===this.latestFrameIndex?0:Math.max(0,this.latestFrameIndex-t.IX.FIRST_PLAYABLE)}},{key:"getLatestFrame",value:function(){var e=this.getFrames(),n=null!==this.latestFrameIndex?this.latestFrameIndex:t.IX.FIRST;return I.default.get(e,this.gameEnd?n:n-1)||null}},{key:"getSettings",value:function(){return this.settingsComplete?this.settings:null}},{key:"getGameEnd",value:function(){return this.gameEnd}},{key:"getFrames",value:function(){return this.frames}},{key:"getRollbackFrames",value:function(){return{frames:this.rollbackCounter.getFrames(),count:this.rollbackCounter.getCount(),lengths:this.rollbackCounter.getLengths()}}},{key:"getFrame",value:function(e){return this.frames[e]||null}},{key:"_handleGameEnd",value:function(e){null!==this.latestFrameIndex&&this.latestFrameIndex!==this.lastFinalizedFrame&&this._finalizeFrames(this.latestFrameIndex),this.gameEnd=e,this.emit(t.zo.END,this.gameEnd)}},{key:"_handleGameStart",value:function(e){this.settings=e,this.settings.players=e.players.filter((function(e){return 3!==e.type})),e.slpVersion&&C.default.gte(e.slpVersion,"1.6.0")&&this._completeSettings()}},{key:"_handlePostFrameUpdate",value:function(e){if(!this.settingsComplete){if(e.frame<=t.IX.FIRST){var n=e.playerIndex,a=I.default.keyBy(this.settings.players,"playerIndex");switch(e.internalCharacterId){case 7:a[n].characterId=19;break;case 19:a[n].characterId=18}}e.frame>t.IX.FIRST&&this._completeSettings()}}},{key:"_handleFrameUpdate",value:function(e,n){var a=e===t.mY.PRE_FRAME_UPDATE?"pre":"post",r=n.isFollower?"followers":"players",i=n.frame;if(this.latestFrameIndex=i,"pre"===a&&!n.isFollower){var s=this.frames[i];this.rollbackCounter.checkIfRollbackFrame(s,n.playerIndex)&&this.emit(t.zo.ROLLBACK_FRAME,s)}I.default.set(this.frames,[i,r,n.playerIndex,a],n),I.default.set(this.frames,[i,"frame"],i);var o=this.getSettings();!o||o.slpVersion&&!C.default.lte(o.slpVersion,"2.2.0")?I.default.set(this.frames,[i,"isTransferComplete"],!1):(this.emit(t.zo.FRAME,this.frames[i]),this._finalizeFrames(i-1))}},{key:"_handleItemUpdate",value:function(e){var t,n,a=e.frame,r=null!=(t=null==(n=this.frames[a])?void 0:n.items)?t:[];r.push(e),I.default.set(this.frames,[a,"items"],r)}},{key:"_handleFrameBookend",value:function(e){var n=e.latestFinalizedFrame,a=e.frame;if(I.default.set(this.frames,[a,"isTransferComplete"],!0),this.emit(t.zo.FRAME,this.frames[a]),this.settings.gameMode===t.GF.ONLINE&&n>=t.IX.FIRST){if(this.options.strict&&n<a-7)throw new Error("latestFinalizedFrame should be within 7 frames of ".concat(a));this._finalizeFrames(n)}else this._finalizeFrames(a-7)}},{key:"_finalizeFrames",value:function(e){for(;this.lastFinalizedFrame<e;){var n=this.lastFinalizedFrame+1,a=this.getFrame(n);if(this.options.strict){var r,i=s(this.settings.players);try{for(i.s();!(r=i.n()).done;){var o=r.value,l=a.players[o.playerIndex];if(!(this.settings.players.length>2)||l){var u=l.pre,T=l.post;if(!u||!T)throw new Error("Could not finalize frame ".concat(n," of ").concat(e,": missing ").concat(u?"pre":"post","-frame update for player ").concat(o.playerIndex))}}}catch(E){i.e(E)}finally{i.f()}}this.emit(t.zo.FINALIZED_FRAME,a),this.lastFinalizedFrame=n}}},{key:"_completeSettings",value:function(){this.settingsComplete||(this.settingsComplete=!0,this.emit(t.zo.SETTINGS,this.settings))}}]),a}(_.EventEmitter);t.v6=function(){function e(n,a){var r=this;u(this,e),this.input=void 0,this.metadata=null,this.finalStats=null,this.parser=void 0,this.readPosition=null,this.actionsComputer=new te,this.conversionComputer=new oe,this.comboComputer=new se,this.stockComputer=new Re,this.inputComputer=new le,this.statsComputer=void 0,this.input=function(e){if("string"==typeof e)return{source:he.FILE,filePath:e};if(e instanceof ArrayBuffer)return{source:he.BUFFER,buffer:new Uint8Array(e)};if(e instanceof Uint8Array)return{source:he.BUFFER,buffer:e};throw new Error("Cannot create SlippiGame with input of that type")}(n),this.statsComputer=new Ae(a),this.statsComputer.register(this.actionsComputer,this.comboComputer,this.conversionComputer,this.inputComputer,this.stockComputer),this.parser=new Ke,this.parser.on(t.zo.SETTINGS,(function(e){r.statsComputer.setup(e)})),this.parser.on(t.zo.FINALIZED_FRAME,(function(e){r.statsComputer.addFrame(e)}))}return T(e,[{key:"_process",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null===this.parser.getGameEnd()){var a=function(e){var n=function(e){if(Se(e).source===me.BUFFER)return e.buffer||new Uint8Array;throw new Error("Source type not supported")}(e),a=n[0]!=="{".charCodeAt(0)?0:15;return{full_data:n,rawDataPosition:a,rawDataLength:function(e,t){var n=e.length;if(0===t)return n;var a=e.slice(t-4,t),r=a[0]<<24|a[1]<<16|a[2]<<8|a[3];return r>0?r:n-t}(n,a),messageSizes:function(e,n){var a={};if(0===n)return a[54]=320,a[55]=6,a[56]=70,a[57]=1,a;var r=e.slice(n,n+2);if(r[0]!==t.mY.MESSAGE_SIZES)return{};var i=r[1];a[53]=i;for(var s=e.slice(n+2,n+i+1),o=0;o<i-1;o+=3)a[s[o]]=s[o+1]<<8|s[o+2];return a}(n,a)}}(this.input);this.readPosition=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=e.full_data,r=null!==n&&n>0?n:e.rawDataPosition,i=e.rawDataPosition+e.rawDataLength;r<i;){var s=a[r],o=e.messageSizes[s]+1;if(void 0===o)return r;if(o>i-r)return r;if(t(s,Oe(s,a.slice(r,r+o))))break;r+=o}return r}(a,(function(t,a){return!!a&&(e.parser.handleCommand(t,a),n&&null!==e.parser.getSettings())}),this.readPosition)}}},{key:"getSettings",value:function(){return this._process(!0),this.parser.getSettings()}},{key:"getLatestFrame",value:function(){return this._process(),this.parser.getLatestFrame()}},{key:"getGameEnd",value:function(){return this._process(),this.parser.getGameEnd()}},{key:"getFrames",value:function(){return this._process(),this.parser.getFrames()}},{key:"getRollbackFrames",value:function(){return this._process(),this.parser.getRollbackFrames()}},{key:"getStats",value:function(){if(this.finalStats)return this.finalStats;this._process();var e=this.parser.getSettings();if(null===e)return null;this.statsComputer.process();var t=this.inputComputer.fetch(),n=this.stockComputer.fetch(),a=Te({settings:e,inputs:t,conversions:this.conversionComputer.fetch(),playableFrameCount:this.parser.getPlayableFrameCount()}),r={gameComplete:null!==this.parser.getGameEnd(),lastFrame:this.parser.getLatestFrameNumber(),stocks:n,last_combo:this.comboComputer.fetch(),actionCounts:this.actionsComputer.fetch(),settings:e,inputs:t,overall:a};return null!==this.parser.getGameEnd()&&(this.finalStats=r),r}},{key:"getMetadata",value:function(){return this.metadata||(this.metadata=function(e){var t=Se(e),n=function(e){return pe(e,1,0)[0]!=="{".charCodeAt(0)?0:15}(t),a=function(e,t){var n=Ie(e);if(0===t)return n;var a=pe(e,4,t-4),r=a[0]<<24|a[1]<<16|a[2]<<8|a[3];return r>0?r:n-t}(t,n),r=n+a+10,i=Ie(t)-r-1;if(i<=0)return null;var s=pe(t,i,r);try{return d.decode(s)}catch(e){return null}}(this.input)),this.metadata}},{key:"getFilePath",value:function(){var e;return this.input.source!==he.FILE?null:null!=(e=this.input.filePath)?e:null}}]),e}(),f.Writable},6958:function(){},3327:function(){}}]);
//# sourceMappingURL=222.3478b55e.chunk.js.map